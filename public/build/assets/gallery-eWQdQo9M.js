import{g as m}from"./auth-CrJnzGtq.js";async function I(){var e=$("#global-event-data").val(),t=$("#global-event-data").data("eventGalleryUrl");if($("#global-event-data").data("eventHasP"))if(localStorage.getItem(e)){var o=await m();axios.post(t,{_token:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),password:localStorage.getItem(e)},{headers:{pageToken:o}}).then(a=>{a.data.success?setTimeout(()=>{document.querySelector(".main-container").classList.remove("auth-checking"),k()},5):L()}).catch(a=>{L()})}else L();else setTimeout(()=>{document.querySelector(".main-container").classList.remove("auth-checking"),k()},5)}function k(){const e=document.getElementById("page-loader");e&&(e.style.display="none")}async function B(){var t,o;const e=await m();try{if(!(await fetch("/events/check-token",{method:"GET",headers:{pageToken:e}})).ok)throw new Error("Unauthorized");I()}catch{window.location.href=((o=(t=document.getElementById("main-page-url"))==null?void 0:t.dataset)==null?void 0:o.url)||"/"}}B();async function L(){var e=$("#global-event-data").data("url"),t=await m();axios.get(e,{headers:{pageToken:t}}).then(o=>{window.location.href=o.data.url}).catch(o=>{console.log(o)})}function E(e){var t=e.target.closest(".scroll-arrow"),o=t.dataset.distance;document.getElementById("tabs").scrollBy({left:o,behavior:"smooth"}),y()}function y(){const e=document.getElementById("tabs");e.scrollLeft,e.scrollWidth,e.clientWidth}function P(e){var t=e.target.closest(".video-item"),o=t.dataset.url,a=t.dataset.videoId,r=t.dataset.incrementView;const n=document.getElementById("videoIframe"),l=`${o}?autoplay=true`;n.src=l;const s=new playerjs.Player(n);s.on("ready",()=>{s.play()}),s.on("error",f=>{console.log("Error occurred:",f)}),s.on("ended",()=>{$.ajax({url:r,method:"GET",success:function(f){console.log(a),$("#video-"+a).text(f.view_count),console.log(f.view_count)}}),s.pause()})}const C=document.querySelector(".refresh-button");C&&C.addEventListener("click",function(e){var t=e.target;document.getElementById(t.dataset.id).click()});async function T(e){e.preventDefault();var t=e.target.closest(".folder"),o=t.dataset.id,a=t.dataset.type,r=t.dataset.url,n=t.dataset.folderLink,l=t.dataset.hasPassword,s=$('meta[name="csrf-token"]').attr("content");l?j(o,a,n,s,r):x(o,a,n,s,r)}async function j(e,t,o,a,r){try{(await Swal.fire({html:`
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <img src="/assets/img/illustrations/love-lock-dark.svg" width="80" alt="Love Lock Icon" style="margin-bottom: 10px;" />
                    <p>This Folder is Private, Please Provide a Password to Enter</p>
                </div>
            `,input:"password",inputLabel:"",inputPlaceholder:"Enter Folder Password",inputAttributes:{maxlength:50,autocapitalize:"off",autocorrect:"off"},showCancelButton:!0,confirmButtonText:"Enter",cancelButtonText:"Cancel",allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:async l=>{if(!l)Swal.showValidationMessage("Password is required"),Promise.reject();else try{return await _(l,e)||(Swal.showValidationMessage("Invalid password"),Promise.reject()),l}catch(s){console.error("Validation error:",s),Swal.showValidationMessage(s.message||"Error validating password"),Promise.reject()}}})).isConfirmed&&await x(e,t,o,a,r)}catch(n){console.error("Password prompt error:",n)}}async function _(e,t){return new Promise(async(o,a)=>{var r=document.getElementById("check_folder_password_url").value,n=await m();$.ajax({url:r,type:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),folder_id:t,password:e},headers:{pageToken:n},success:function(l){o(l)},error:function(l,s,f){console.error("Password validation error:",f),a(f)}})})}async function x(e,t,o,a,r){if($(".refresh-button").attr("data-id","folder-"+e),t=="link")return window.open(o,"_blank","noopener,noreferrer"),!1;if(t=="fake")return!1;$("#gallery-div").hide(),$("#loader-div").attr("hidden",!1);var n=await m();axios.post(r,{_token:a,folder_id:e},{headers:{pageToken:n}}).then(l=>{var s=l.data;if($("#gallery-div").html(s.html),t=="video")$.getScript("//assets.mediadelivery.net/playerjs/player-0.1.0.min.js").then(()=>{const d=document.getElementById("videoIframe");if(!d.src||d.src==="about:blank"){var h=null;s.files.forEach(g=>{h==null&&g.file_status=="approved"&&(h=g.file)}),d.src=h}const p=new playerjs.Player(d,{autoplay:!1,mute:!0,loop:!0,volume:.1,controls:!0,fullscreen:!0,showTitle:!1,startTime:0,enableVideoInfo:!0});d.onload=function(){p.pause(),p.mute()},p.on("error",g=>{console.error("Error occurred:",g)})}),document.querySelectorAll(".video-item").forEach(d=>{d.addEventListener("click",P)}),$("#gallery-div").show(),$("#loader-div").attr("hidden",!0),$(".refresh-button").removeClass("disabled");else if(t=="image"){var f=s.eventSupportDownload?"download":"";$.getScript("https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js").done(function(){$('[data-fancybox="gallery"]').fancybox({clickOutside:"close",buttons:["zoom","slideShow","fullScreen",f,"delete","close"],btnTpl:{delete:`<button data-fancybox-delete class="fancybox-button fancybox-button--delete" title="Delete" hidden>
                           <svg viewBox="300 -100 500 900" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M446.857 400C533.645 400 604 470.355 604 557.143C604 643.93 533.645 714.286 446.857 714.286C360.07 714.286 289.714 643.93 289.714 557.143C289.714 470.355 360.07 400 446.857 400ZM289.714 0C350.92 0 400.888 48.1134 403.86 108.582L404 114.286H546.857C562.637 114.286 575.429 127.078 575.429 142.857C575.429 157.51 564.399 169.586 550.189 171.236L546.857 171.429H522.6L505.621 380.917C487.152 374.762 467.394 371.429 446.857 371.429C344.29 371.429 261.143 454.576 261.143 557.143C261.143 607.054 280.832 652.367 312.867 685.738L197.331 685.714C141.516 685.714 95.0499 642.864 90.5391 587.23L56.8 171.429H32.5714C17.919 171.429 5.84265 160.399 4.19222 146.189L4 142.857C4 128.205 15.0297 116.128 29.2394 114.478L32.5714 114.286H175.429C175.429 51.1675 226.596 0 289.714 0ZM396.312 486.404L394.333 484.751C389.461 481.376 382.959 481.376 378.087 484.751L376.109 486.404L374.456 488.382C371.081 493.254 371.081 499.757 374.456 504.628L376.109 506.607L426.667 557.163L376.183 607.643L374.529 609.621C371.155 614.493 371.155 620.995 374.529 625.867L376.183 627.846L378.161 629.499C383.033 632.874 389.535 632.874 394.407 629.499L396.386 627.846L446.867 577.363L497.411 627.91L499.39 629.563C504.261 632.938 510.764 632.938 515.636 629.563L517.614 627.91L519.267 625.931C522.642 621.06 522.642 614.557 519.267 609.685L517.614 607.707L467.067 557.163L517.693 506.608L519.346 504.63C522.721 499.758 522.721 493.256 519.346 488.384L517.693 486.405L515.715 484.752C510.843 481.377 504.341 481.377 499.469 484.752L497.49 486.405L446.867 536.963L396.312 486.404ZM289.714 57.1429C259.59 57.1429 234.91 80.4536 232.728 110.021L232.571 114.286H346.857L346.7 110.021C344.519 80.4536 319.839 57.1429 289.714 57.1429Z" fill="#CCCCCC"/>
                                </svg>
                                </button>`},afterLoad:function(i,c){h(i,c)},afterShow:function(i,c){h(i,c)},beforeShow:function(i,c){$(i.$refs.toolbar).find(".fancybox-button--delete").off("click").on("click",function(){$(this).is(":disabled")||($(".fancybox-container").css("z-index","99999"),Swal.fire({title:"Are you sure?",text:"This image will be permanently deleted.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",customClass:{popup:"swal2-override-zindex"}}).then(u=>{u.isConfirmed&&d(c,i)}))})}});async function d(i,c){const v=i.opts.$orig.data("image-id");var u=await m();axios.post("/delete-image/"+v,{_token:a,folder_id:e},{headers:{pageToken:u}}).then(w=>{c.close(),w.data.success?(Swal.fire({position:"top",title:"Done!",text:w.message||"Image was deleted successfully",icon:"success",showConfirmButton:!1,showCloseButton:!0}),i.opts.$orig.closest(".grid-item").remove()):Swal.fire({position:"top",title:"Error!",text:w.data.message||"Delete failed",icon:"error"})}).catch(w=>{var b;c.close(),Swal.fire({position:"top",title:"Error!",text:((b=w.responseJSON)==null?void 0:b.message)||"Delete failed",icon:"error"})})}function h(i,c){const u=c.opts.$orig.data("can-delete")===!0;$(i.$refs.toolbar).find(".fancybox-button--delete").toggle(u)}const p=(i,c)=>{i.forEach(v=>{if(v.isIntersecting){const u=v.target;u.src=u.getAttribute("data-src"),u.removeAttribute("data-src"),c.unobserve(u),V()}})},g=new IntersectionObserver(p,{root:null,rootMargin:"0px",threshold:.1});document.querySelectorAll("#gallery img[data-src]").forEach(i=>g.observe(i)),$("#gallery-div").show(),$("#loader-div").attr("hidden",!0),$(".refresh-button").removeClass("disabled")}).fail(d=>{console.log(d)}),document.getElementById("tabs").addEventListener("scroll",y),window.removeEventListener("load",y),window.addEventListener("load",y)}}).catch(l=>{$("#loader-div").attr("hidden",!0),console.log(l.response.data.message)})}document.querySelectorAll(".folder-thumbnail").forEach(e=>{e.addEventListener("click",T)});document.getElementById("scroll-left").addEventListener("click",E);document.getElementById("scroll-right").addEventListener("click",E);async function q(e){e.preventDefault();var t=e.target.closest("a"),o=t.dataset.url,a=t.dataset.supportImageUpload;if(a){var r=await m();axios.get(o,{headers:{pageToken:r}}).then(n=>{window.location.href=n.data.url}).catch(n=>{console.log(n)})}}document.querySelector(".share-btn-div").addEventListener("click",q);function S(){if(window.tokenInitialized){var e=$(".horizontal-scroll").children(".folder-thumbnail").first();e.click()}else setTimeout(S,100)}$(document).ready(function(){S()});function V(){document.querySelectorAll(".grid-item").forEach(t=>{const o=t.querySelector("img");if(!o.hasAttribute("src"))return;const a=()=>{const r=o.naturalHeight,n=o.naturalWidth;window.innerWidth<560?r>n?t.style.gridRowEnd="span 16":t.style.gridRowEnd="span 8":r>n?t.style.gridRowEnd="span 20":t.style.gridRowEnd="span 10"};o.onload=a,o.complete&&a()})}document.addEventListener("click",function(e){const t=e.target.closest(".fancybox-button--download");t&&(e.preventDefault(),fetch(t.href).then(o=>o.blob()).then(o=>{const a=URL.createObjectURL(o),r=document.createElement("a");r.href=a,r.download=t.href.split("/").pop(),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}).catch(o=>{console.error("Download failed:",o)}))});
